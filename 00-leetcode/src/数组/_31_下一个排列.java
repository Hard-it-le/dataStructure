package æ•°ç»„;

import java.util.Arrays;

/**
 * @program: data-structure
 * @author: yjl
 * @created: 2021/11/03
 */
//å®ç°è·å– ä¸‹ä¸€ä¸ªæ’åˆ— çš„å‡½æ•°ï¼Œç®—æ³•éœ€è¦å°†ç»™å®šæ•°å­—åºåˆ—é‡æ–°æ’åˆ—æˆå­—å…¸åºä¸­ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ’åˆ—ï¼ˆå³ï¼Œç»„åˆå‡ºä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•´æ•°ï¼‰ã€‚
//
// å¦‚æœä¸å­˜åœ¨ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ’åˆ—ï¼Œåˆ™å°†æ•°å­—é‡æ–°æ’åˆ—æˆæœ€å°çš„æ’åˆ—ï¼ˆå³å‡åºæ’åˆ—ï¼‰ã€‚
//
// å¿…é¡» åŸåœ° ä¿®æ”¹ï¼Œåªå…è®¸ä½¿ç”¨é¢å¤–å¸¸æ•°ç©ºé—´ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼šnums = [1,2,3]
//è¾“å‡ºï¼š[1,3,2]
//
//
// ç¤ºä¾‹ 2ï¼š
//
//
//è¾“å…¥ï¼šnums = [3,2,1]
//è¾“å‡ºï¼š[1,2,3]
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
//è¾“å…¥ï¼šnums = [1,1,5]
//è¾“å‡ºï¼š[1,5,1]
//
//
// ç¤ºä¾‹ 4ï¼š
//
//
//è¾“å…¥ï¼šnums = [1]
//è¾“å‡ºï¼š[1]
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= nums.length <= 100
// 0 <= nums[i] <= 100
//
// Related Topics æ•°ç»„ åŒæŒ‡é’ˆ ğŸ‘ 1395 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
public class _31_ä¸‹ä¸€ä¸ªæ’åˆ— {

    /**
     * ä¸€æ¬¡éå†
     * æ€è·¯ï¼šä»åå‘å‰æ‰¾åˆ°å‡åºå­åºåˆ—ï¼Œç„¶åç¡®å®šè°ƒæ•´åå­åºåˆ—çš„æœ€é«˜ä½ï¼Œå‰©ä½™éƒ¨åˆ†å‡åºæ’åˆ—
     *
     * @param nums
     */
    // æ€è·¯ï¼šä»åå‘å‰æ‰¾åˆ°å‡åºå­åºåˆ—ï¼Œç„¶åç¡®å®šè°ƒæ•´åå­åºåˆ—çš„æœ€é«˜ä½ï¼Œå‰©ä½™éƒ¨åˆ†å‡åºæ’åˆ—
    public void nextPermutation01(int[] nums) {
        int n = nums.length;
        // 1. ä»åå‘å‰æ‰¾åˆ°å‡åºå­åºåˆ—ï¼Œæ‰¾åˆ°ç¬¬ä¸€æ¬¡ä¸‹é™çš„æ•°ï¼Œä½ç½®è®°ä¸ºk
        int k = n - 2;
        while (k >= 0 && nums[k] >= nums[k + 1]) {
            k--;
        }
        // æ‰¾åˆ°kï¼Œå°±æ˜¯éœ€è¦è°ƒæ•´éƒ¨åˆ†çš„æœ€é«˜ä½
        // 2. å¦‚æœk = -1ï¼Œè¯´æ˜æ‰€æœ‰æ•°é™åºæ’åˆ—ï¼Œæ”¹æˆå‡åºæ’åˆ—
        if (k == -1) {
            Arrays.sort(nums);
            return;
        }
        // 3. ä¸€èˆ¬æƒ…å†µï¼Œk >= 0
        // 3.1 ä¾æ¬¡éå†å‰©ä½™é™åºæ’åˆ—çš„éƒ¨åˆ†ï¼Œæ‰¾åˆ°è¦æ›¿æ¢æœ€é«˜ä½çš„é‚£ä¸ªæ•°
        int i = k + 2;
        while (i < n && nums[i] > nums[k]) {
            i++;
        }
        // å½“å‰çš„iï¼Œå°±æ˜¯åé¢éƒ¨åˆ†ç¬¬ä¸€ä¸ªæ¯”nums[k]å°çš„æ•°ï¼Œi-1å°±æ˜¯è¦æ›¿æ¢çš„é‚£ä¸ªæ•°
        // 3.2 äº¤æ¢i-1å’Œkä½ç½®ä¸Šçš„æ•°
        int temp = nums[k];
        nums[k] = nums[i - 1];
        nums[i - 1] = temp;
        // 3.3 kä¹‹åçš„å‰©ä½™éƒ¨åˆ†å˜æˆå‡åºæ’åˆ—ï¼Œç›´æ¥å‰åè°ƒæ¢
        int start = k + 1;
        int end = n - 1;
        while (start < end) {
            int tmp = nums[start];
            nums[start] = nums[end];
            nums[end] = tmp;
            start++;
            end--;
        }
    }

    /**
     * æ–¹æ³•æ”¹è¿›ï¼šå°†é™åºæ•°ç»„ç¿»è½¬çš„æ“ä½œæå–å‡ºæ¥
     *
     * @param nums
     */
    public void nextPermutation02(int[] nums) {
        int n = nums.length;
        // 1. ä»åå‘å‰æ‰¾åˆ°å‡åºå­åºåˆ—ï¼Œæ‰¾åˆ°ç¬¬ä¸€æ¬¡ä¸‹é™çš„æ•°ï¼Œä½ç½®è®°ä¸ºk
        int k = n - 2;
        while (k >= 0 && nums[k] >= nums[k + 1]) {
            k--;
        }
        // æ‰¾åˆ°kï¼Œå°±æ˜¯éœ€è¦è°ƒæ•´éƒ¨åˆ†çš„æœ€é«˜ä½
        // 2. å¦‚æœk = -1ï¼Œè¯´æ˜æ‰€æœ‰æ•°é™åºæ’åˆ—ï¼Œæ”¹æˆå‡åºæ’åˆ—
        if (k == -1) {
            reverse(nums, 0, n - 1);
            return;
        }

        // 3. ä¸€èˆ¬æƒ…å†µï¼Œk >= 0
        // 3.1 ä¾æ¬¡éå†å‰©ä½™é™åºæ’åˆ—çš„éƒ¨åˆ†ï¼Œæ‰¾åˆ°è¦æ›¿æ¢æœ€é«˜ä½çš„é‚£ä¸ªæ•°
        int i = k + 2;
        while (i < n && nums[i] > nums[k]) {
            i++;
        }

        // å½“å‰çš„iï¼Œå°±æ˜¯åé¢éƒ¨åˆ†ç¬¬ä¸€ä¸ªæ¯”nums[k]å°çš„æ•°ï¼Œi-1å°±æ˜¯è¦æ›¿æ¢çš„é‚£ä¸ªæ•°
        // 3.2 äº¤æ¢i-1å’Œkä½ç½®ä¸Šçš„æ•°
        swap(nums, k, i - 1);

        // 3.3 kä¹‹åçš„å‰©ä½™éƒ¨åˆ†å˜æˆå‡åºæ’åˆ—ï¼Œç›´æ¥å‰åè°ƒæ¢
        reverse(nums, k + 1, n - 1);
    }

    /**
     * å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œäº¤æ¢æ•°ç»„ä¸­ä¸¤ä¸ªå…ƒç´ 
     *
     * @param nums
     * @param i
     * @param j
     */
    private void swap(int[] nums, int i, int j) {
        int temp = nums[i];
        nums[i] = nums[j];
        nums[j] = temp;
    }

    /**
     * å®šä¹‰ä¸€ä¸ªç¿»è½¬æ•°ç»„çš„æ–¹æ³•
     *
     * @param nums
     * @param start
     * @param end
     */
    private void reverse(int[] nums, int start, int end) {
        while (start < end) {
            swap(nums, start, end);
            start++;
            end--;
        }
    }

    public static void main(String[] args) {
        int[] nums = {1, 5, 8, 4, 6, 5, 4, 3, 2, 1};
        _31_ä¸‹ä¸€ä¸ªæ’åˆ— v = new _31_ä¸‹ä¸€ä¸ªæ’åˆ—();
        v.nextPermutation02(nums);
        for (int num : nums) {
            System.out.print(num + ",");
        }
    }
}
